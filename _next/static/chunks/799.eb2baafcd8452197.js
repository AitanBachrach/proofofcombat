"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[799],{2799:function(n,t,e){e.r(t),e.d(t,{default:function(){return G}});var r=e(5893),o=e(7294),a=e(1163),i=e(1458),c=e(2192),l=e(4051),u=e.n(l),s=e(1157),f=e(8445),d=e(5449),h=e(7357),v=e(9402);function m(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}function p(n,t,e,r,o,a,i){try{var c=n[a](i),l=c.value}catch(u){return void e(u)}c.done?t(l):Promise.resolve(l).then(r,o)}function y(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function i(n){p(a,r,o,i,c,"next",n)}function c(n){p(a,r,o,i,c,"throw",n)}i(void 0)}))}}function x(n){return function(n){if(Array.isArray(n))return m(n)}(n)||function(n){if("undefined"!==typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,t){if(!n)return;if("string"===typeof n)return m(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);"Object"===e&&n.constructor&&(e=n.constructor.name);if("Map"===e||"Set"===e)return Array.from(e);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return m(n,t)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var g="https://chrisinajar.com:5000/";function b(){var n,t,e=function(n){return n.trim()},a=(0,v.TX)().data,i=(0,o.useState)([]),c=i[0],l=i[1],m=(0,o.useState)(!1),p=m[0],b=m[1],j=(0,o.useState)(""),w=j[0],k=j[1],Z=(0,o.useRef)();(0,o.useEffect)((function(){var n;if(!Z.current&&(null===a||void 0===a||null===(n=a.chat)||void 0===n?void 0:n.token))return Z.current=(0,s.io)(g,{withCredentials:!0,auth:{token:a.chat.token}}),Z.current.on("hello",(function(n){l(n.chat)})),Z.current.on("chat",(function(n){console.log("Got chat event!",n),l((function(t){return[n].concat(x(t))}))})),function(){Z.current&&(Z.current.disconnect(),Z.current=void 0)}}),[null===a||void 0===a||null===(n=a.chat)||void 0===n?void 0:n.token]);var A=e(w);function S(){return(S=y(u().mark((function n(t){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("Enter"===t.key&&Z.current){n.next=2;break}return n.abrupt("return");case 2:Z.current.emit("chat",{message:w},(function(n){console.log("Got a reply!",n),l((function(t){return[n].concat(x(t))}))})),k("");case 4:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return(0,r.jsxs)(o.Fragment,{children:[(0,r.jsx)(d.Z,{fullWidth:!0,disabled:!(null===(t=Z.current)||void 0===t?void 0:t.connected),value:w,name:"Chat input",label:p?"Max message: ".concat(A.length,"/").concat(140):"Type here...",placeholder:"Type here...",onChange:function(n){var t=n.target.value;e(t).length<=140&&k(t)},onFocus:function(){return b(!0)},onBlur:function(){return b(!1)},autoComplete:"off",onKeyPress:function(n){return S.apply(this,arguments)}}),(0,r.jsx)(h.Z,{sx:{backgroundColor:"primary.light",padding:1,minHeight:"600px"},children:c.map((function(n){return(0,r.jsxs)("div",{children:[(0,r.jsx)("b",{children:n.from})," ",(0,f.emojify)(n.message)]},n.id)}))}),(0,r.jsx)("br",{})]})}var j=e(3321),w=e(6886),k=e(913),Z=e(3841),A=e(5696),S=e(3599),C=e(5861),I=e(8456);function P(n,t){if(n===v.hK.Melee)return t?"struck":"missed"}function E(n){var t=n.fight,e=t.monster.monster;return(0,r.jsx)(o.Fragment,{children:(0,r.jsxs)(w.ZP,{item:!0,xs:6,children:[t.log.map((function(n){return(0,r.jsx)(o.Fragment,{children:(0,r.jsxs)(C.Z,{children:[(0,r.jsx)("b",{children:n.from})," ".concat(P(n.attackType,n.success)," "),(0,r.jsx)("b",{children:n.to}),n.success?" for ".concat(n.damage," damage!"):"."]})},n.from)})),t.victory&&(0,r.jsxs)(C.Z,{children:[e.name," has been killed!"]})]})})}function F(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}function O(n,t,e,r,o,a,i){try{var c=n[a](i),l=c.value}catch(u){return void e(u)}c.done?t(l):Promise.resolve(l).then(r,o)}function T(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function i(n){O(a,r,o,i,c,"next",n)}function c(n){O(a,r,o,i,c,"throw",n)}i(void 0)}))}}function M(n,t){return function(n){if(Array.isArray(n))return n}(n)||function(n,t){var e=null==n?null:"undefined"!==typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var r,o,a=[],i=!0,c=!1;try{for(e=e.call(n);!(i=(r=e.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(l){c=!0,o=l}finally{try{i||null==e.return||e.return()}finally{if(c)throw o}}return a}}(n,t)||function(n,t){if(!n)return;if("string"===typeof n)return F(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);"Object"===e&&n.constructor&&(e=n.constructor.name);if("Map"===e||"Set"===e)return Array.from(e);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return F(n,t)}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var U="Select a monster to challenge",H="Fight a monster!";function W(){var n=(0,o.useState)(""),t=n[0],e=n[1],a=(0,o.useState)(""),i=a[0],c=a[1],l=(0,v.Of)(),s=l.data,f=l.loading,d=(l.error,l.refetch),h=M((0,v.zC)(),2),m=h[0],p=h[1].data,y=M((0,v.Ht)(),1)[0],x=M((0,v.hL)(),1)[0],g=(0,v.pL)(),b=g.data,P=g.refetch,F=(null===b||void 0===b?void 0:b.challenges)||[],O=function(){var n,t,e,r=(0,v.UE)().data;return null!==(e=null===r||void 0===r||null===(n=r.me)||void 0===n||null===(t=n.account)||void 0===t?void 0:t.hero)&&void 0!==e?e:void 0}();function W(){return(W=T(u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,x();case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),n,null,[[0,5]])})))).apply(this,arguments)}function _(){return(_=T(u().mark((function n(){var t,e;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=4,m({variables:{monster:i}});case 4:e=n.sent,(null===(t=e.data)||void 0===t?void 0:t.fight.victory)&&(c(""),d()),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),d();case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))).apply(this,arguments)}function R(){return(R=T(u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,y({variables:{monster:t}});case 3:d(),n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),d();case 9:case"end":return n.stop()}}),n,null,[[0,6]])})))).apply(this,arguments)}return(0,o.useEffect)((function(){P()}),[null===O||void 0===O?void 0:O.location.x,null===O||void 0===O?void 0:O.location.y,null===O||void 0===O?void 0:O.location.map]),(0,r.jsx)(o.Fragment,{children:(0,r.jsxs)(w.ZP,{container:!0,columns:6,spacing:4,children:[p&&(0,r.jsx)(E,{fight:p.fight}),O&&O.combat.health>0&&(0,r.jsxs)(o.Fragment,{children:[(0,r.jsx)(w.ZP,{item:!0,md:3,xs:6,children:(0,r.jsxs)(k.Z,{fullWidth:!0,children:[(0,r.jsx)(Z.Z,{id:"challenge-monster-select-label",children:U}),(0,r.jsx)(A.Z,{labelId:"challenge-monster-select-label",value:t,label:U,onChange:function(n){return e(n.target.value)},children:F.map((function(n){return(0,r.jsx)(S.Z,{value:n.id,children:n.name},n.id)}))}),(0,r.jsx)(j.Z,{disabled:!t,onClick:function(){return R.apply(this,arguments)},variant:"contained",children:"Challenge!"})]})}),(0,r.jsx)(w.ZP,{item:!0,md:3,xs:6,children:(0,r.jsxs)(k.Z,{fullWidth:!0,children:[(0,r.jsx)(Z.Z,{id:"fight-monster-select-label",children:H}),(0,r.jsx)(A.Z,{labelId:"fight-monster-select-label",value:i,label:H,onChange:function(n){return c(n.target.value)},children:(null===s||void 0===s?void 0:s.monsters)&&(null===s||void 0===s?void 0:s.monsters.map((function(n){return(0,r.jsx)(S.Z,{value:n.id,children:n.monster.name},n.id)})))}),f&&(0,r.jsx)(I.Z,{}),(0,r.jsx)(j.Z,{disabled:!i,onClick:function(){return _.apply(this,arguments)},variant:"contained",children:"Fight!"})]})})]}),O&&O.combat.health<=0&&(0,r.jsx)(w.ZP,{item:!0,lg:3,xs:6,children:(0,r.jsx)(C.Z,{children:"You are dead."})}),(0,r.jsx)(w.ZP,{item:!0,lg:3,xs:6,children:(0,r.jsx)(j.Z,{fullWidth:!0,onClick:function(){return W.apply(this,arguments)},variant:"contained",children:"Heal"})})]})})}var _=e(9692);function R(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}function $(n,t){return function(n){if(Array.isArray(n))return n}(n)||function(n,t){var e=null==n?null:"undefined"!==typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var r,o,a=[],i=!0,c=!1;try{for(e=e.call(n);!(i=(r=e.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(l){c=!0,o=l}finally{try{i||null==e.return||e.return()}finally{if(c)throw o}}return a}}(n,t)||function(n,t){if(!n)return;if("string"===typeof n)return R(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);"Object"===e&&n.constructor&&(e=n.constructor.name);if("Map"===e||"Set"===e)return Array.from(e);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return R(n,t)}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(){var n=(0,a.useRouter)(),t=$((0,_.d)(),2),e=t[0],o=(t[1],(0,v.UE)()),l=(o.data,o.loading);return o.error||!e?(n.push("/?auth=".concat(n.asPath)),(0,r.jsxs)(c.A,{children:[(0,r.jsx)("br",{}),"Redirecting..."]})):l?(0,r.jsx)(c.A,{children:l&&(0,r.jsx)(i.Z,{})}):(0,r.jsxs)(c.A,{showHero:!0,children:[(0,r.jsx)("br",{}),"You are logged in!",(0,r.jsx)("br",{}),"I am actively adding new features to this kind of constantly.",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)(W,{}),(0,r.jsx)("br",{}),(0,r.jsx)(b,{})]})}}}]);