"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[799],{2799:function(n,e,r){r.r(e),r.d(e,{default:function(){return G}});var t=r(5893),o=r(7294),i=r(1163),a=r(1458),l=r(1320),c=r(4051),u=r.n(c),s=r(1157),d=r(8445),f=r(5449),h=r(7357),v=r(9402);function m(n,e){(null==e||e>n.length)&&(e=n.length);for(var r=0,t=new Array(e);r<e;r++)t[r]=n[r];return t}function p(n,e,r,t,o,i,a){try{var l=n[i](a),c=l.value}catch(u){return void r(u)}l.done?e(c):Promise.resolve(c).then(t,o)}function y(n){return function(){var e=this,r=arguments;return new Promise((function(t,o){var i=n.apply(e,r);function a(n){p(i,t,o,a,l,"next",n)}function l(n){p(i,t,o,a,l,"throw",n)}a(void 0)}))}}function x(n){return function(n){if(Array.isArray(n))return m(n)}(n)||function(n){if("undefined"!==typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,e){if(!n)return;if("string"===typeof n)return m(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);"Object"===r&&n.constructor&&(r=n.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m(n,e)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var b="https://chrisinajar.com:5000/";function g(){var n,e,r=function(n){return n.trim()},i=(0,v.TX)().data,a=(0,o.useState)([]),l=a[0],c=a[1],m=(0,o.useState)(!1),p=m[0],g=m[1],j=(0,o.useState)(""),w=j[0],k=j[1],A=(0,o.useRef)();(0,o.useEffect)((function(){var n;if(!A.current&&(null===i||void 0===i||null===(n=i.chat)||void 0===n?void 0:n.token))return A.current=(0,s.io)(b,{withCredentials:!0,auth:{token:i.chat.token}}),A.current.on("hello",(function(n){c(n.chat)})),A.current.on("chat",(function(n){console.log("Got chat event!",n),c((function(e){return[n].concat(x(e))}))})),function(){A.current&&(A.current.disconnect(),A.current=void 0)}}),[null===i||void 0===i||null===(n=i.chat)||void 0===n?void 0:n.token]);var S=r(w);function Z(){return(Z=y(u().mark((function n(e){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("Enter"===e.key&&A.current){n.next=2;break}return n.abrupt("return");case 2:A.current.emit("chat",{message:w},(function(n){console.log("Got a reply!",n),c((function(e){return[n].concat(x(e))}))})),k("");case 4:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return(0,t.jsxs)(o.Fragment,{children:[(0,t.jsx)(f.Z,{fullWidth:!0,disabled:!(null===(e=A.current)||void 0===e?void 0:e.connected),value:w,name:"Chat input",label:p?"Max message: ".concat(S.length,"/").concat(140):"Type here...",placeholder:"Type here...",onChange:function(n){var e=n.target.value;r(e).length<=140&&k(e)},onFocus:function(){return g(!0)},onBlur:function(){return g(!1)},autoComplete:"off",onKeyPress:function(n){return Z.apply(this,arguments)}}),(0,t.jsx)(h.Z,{sx:{backgroundColor:"primary.light",padding:1,minHeight:"600px"},children:l.map((function(n){return(0,t.jsxs)("div",{children:[(0,t.jsx)("b",{children:n.from})," ",(0,d.emojify)(n.message)]},n.id)}))}),(0,t.jsx)("br",{})]})}var j=r(3321),w=r(6886),k=r(913),A=r(3841),S=r(5696),Z=r(3599),C=r(5861),E=r(8456);var I=r(9835);function P(n,e){if(n===v.hK.Melee)return e?"struck":"missed"}function F(n){var e=n.fight,r=e.monster.monster;return(0,t.jsx)(o.Fragment,{children:(0,t.jsxs)(w.ZP,{item:!0,xs:6,children:[e.log.map((function(n){return(0,t.jsx)(o.Fragment,{children:(0,t.jsxs)(C.Z,{children:[(0,t.jsx)("b",{children:n.from})," ".concat(P(n.attackType,n.success)," "),(0,t.jsx)("b",{children:n.to}),n.success?" for ".concat(n.damage," damage!"):"."]})},n.from)})),e.victory&&(0,t.jsxs)(C.Z,{children:[r.name," has been killed!",e.experience&&" You gain ".concat(e.experience," experience! "),e.didLevel&&(0,t.jsx)("b",{children:"You leveled up!!"})]})]})})}function T(n,e){(null==e||e>n.length)&&(e=n.length);for(var r=0,t=new Array(e);r<e;r++)t[r]=n[r];return t}function O(n,e,r,t,o,i,a){try{var l=n[i](a),c=l.value}catch(u){return void r(u)}l.done?e(c):Promise.resolve(c).then(t,o)}function L(n){return function(){var e=this,r=arguments;return new Promise((function(t,o){var i=n.apply(e,r);function a(n){O(i,t,o,a,l,"next",n)}function l(n){O(i,t,o,a,l,"throw",n)}a(void 0)}))}}function M(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var r=null==n?null:"undefined"!==typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=r){var t,o,i=[],a=!0,l=!1;try{for(r=r.call(n);!(a=(t=r.next()).done)&&(i.push(t.value),!e||i.length!==e);a=!0);}catch(c){l=!0,o=c}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(n,e)||H(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(n){return function(n){if(Array.isArray(n))return T(n)}(n)||function(n){if("undefined"!==typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||H(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(n,e){if(n){if("string"===typeof n)return T(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?T(n,e):void 0}}var W="Select a monster to challenge",Y="Fight a monster!";function _(){var n=M((0,I.g)(),2),e=n[0],r=n[1],i=(0,o.useState)(""),a=i[0],l=i[1],c=(0,o.useState)(""),s=c[0],d=c[1],f=(0,v.Of)(),h=f.data,m=f.loading,p=(f.error,f.refetch),y=M((0,v.zC)(),2),x=y[0],b=y[1].data,g=M((0,v.Ht)(),1)[0],P=M((0,v.hL)(),1)[0],T=(0,v.pL)(),O=T.data,H=T.refetch,_=(null===O||void 0===O?void 0:O.challenges)||[],Q=function(){var n,e,r,t=(0,v.UE)().data;return null!==(r=null===t||void 0===t||null===(n=t.me)||void 0===n||null===(e=n.account)||void 0===e?void 0:e.hero)&&void 0!==r?r:void 0}();function R(){return(R=L(u().mark((function n(){var e,t;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,P();case 3:n.next=9;break;case 5:n.prev=5,n.t0=n.catch(0),n.t0.graphQLErrors&&(null===(e=n.t0.graphQLErrors[0])||void 0===e||null===(t=e.extensions)||void 0===t?void 0:t.delay)&&r(n.t0.graphQLErrors[0].extensions.remaining);case 9:case"end":return n.stop()}}),n,null,[[0,5]])})))).apply(this,arguments)}function $(){return($=L(u().mark((function n(){var e,r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=4,x({variables:{monster:s}});case 4:r=n.sent,(null===(e=r.data)||void 0===e?void 0:e.fight.victory)&&(d(""),p()),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),p();case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))).apply(this,arguments)}function G(){return(G=L(u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,g({variables:{monster:a}});case 3:p(),n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),p();case 9:case"end":return n.stop()}}),n,null,[[0,6]])})))).apply(this,arguments)}return(0,o.useEffect)((function(){H()}),[null===Q||void 0===Q?void 0:Q.location.x,null===Q||void 0===Q?void 0:Q.location.y,null===Q||void 0===Q?void 0:Q.location.map]),(0,t.jsx)(o.Fragment,{children:(0,t.jsxs)(w.ZP,{container:!0,columns:6,spacing:4,children:[b&&(0,t.jsx)(F,{fight:b.fight}),Q&&Q.combat.health>0&&(0,t.jsxs)(o.Fragment,{children:[(0,t.jsx)(w.ZP,{item:!0,md:3,xs:6,children:(0,t.jsxs)(k.Z,{fullWidth:!0,children:[(0,t.jsx)(A.Z,{id:"challenge-monster-select-label",children:W}),(0,t.jsx)(S.Z,{labelId:"challenge-monster-select-label",value:a,label:W,onChange:function(n){return l(n.target.value)},children:_.map((function(n){return(0,t.jsx)(Z.Z,{value:n.id,children:n.name},n.id)}))}),(0,t.jsx)(j.Z,{disabled:!a||e>0,onClick:function(){return G.apply(this,arguments)},variant:"contained",children:"Challenge!"})]})}),(0,t.jsx)(w.ZP,{item:!0,md:3,xs:6,children:(0,t.jsxs)(k.Z,{fullWidth:!0,children:[(0,t.jsx)(A.Z,{id:"fight-monster-select-label",children:Y}),(0,t.jsx)(S.Z,{labelId:"fight-monster-select-label",value:s,label:Y,onChange:function(n){return d(n.target.value)},children:(null===h||void 0===h?void 0:h.monsters)&&U(null===h||void 0===h?void 0:h.monsters).sort((function(n,e){return n.monster.level-e.monster.level})).map((function(n){return(0,t.jsx)(Z.Z,{value:n.id,children:n.monster.name},n.id)}))}),m&&(0,t.jsx)(E.Z,{}),(0,t.jsx)(j.Z,{disabled:!s||e>0,onClick:function(){return $.apply(this,arguments)},variant:"contained",children:"Fight!"})]})})]}),Q&&Q.combat.health<=0&&(0,t.jsx)(w.ZP,{item:!0,lg:3,xs:6,children:(0,t.jsx)(C.Z,{children:"You are dead."})}),(0,t.jsx)(w.ZP,{item:!0,lg:3,xs:6,children:(0,t.jsx)(j.Z,{fullWidth:!0,onClick:function(){return R.apply(this,arguments)},variant:"contained",disabled:e>0,children:"Heal"})})]})})}var Q=r(9692);function R(n,e){(null==e||e>n.length)&&(e=n.length);for(var r=0,t=new Array(e);r<e;r++)t[r]=n[r];return t}function $(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var r=null==n?null:"undefined"!==typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=r){var t,o,i=[],a=!0,l=!1;try{for(r=r.call(n);!(a=(t=r.next()).done)&&(i.push(t.value),!e||i.length!==e);a=!0);}catch(c){l=!0,o=c}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}}(n,e)||function(n,e){if(!n)return;if("string"===typeof n)return R(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);"Object"===r&&n.constructor&&(r=n.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R(n,e)}(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(){var n=(0,i.useRouter)(),e=$((0,Q.d)(),2),r=e[0],o=(e[1],(0,v.UE)()),c=(o.data,o.loading);return o.error||!r?(n.push("/?auth=".concat(n.asPath)),(0,t.jsxs)(l.A,{children:[(0,t.jsx)("br",{}),"Redirecting..."]})):c?(0,t.jsx)(l.A,{children:c&&(0,t.jsx)(a.Z,{})}):(0,t.jsxs)(l.A,{showHero:!0,children:[(0,t.jsx)("br",{}),"You are logged in!",(0,t.jsx)("br",{}),"I am actively adding new features to this kind of constantly.",(0,t.jsx)("br",{}),(0,t.jsx)("br",{}),(0,t.jsx)(_,{}),(0,t.jsx)("br",{}),(0,t.jsx)(g,{})]})}}}]);