"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[433],{7433:function(e,n,t){t.r(n),t.d(n,{default:function(){return ne}});var r=t(5893),i=t(7294),o=t(1163),a=t(7357),l=t(7720),c=t(1458),s=t(44),u=t(5861),d=t(5670),h=t(7225),f=t(5050),v=t(1320),m=t(4051),x=t.n(m),p=t(1157),y=t(8445),g=t(5449),j=t(9402);function b(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function Z(e,n,t,r,i,o,a){try{var l=e[o](a),c=l.value}catch(s){return void t(s)}l.done?n(c):Promise.resolve(c).then(r,i)}function A(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var o=e.apply(n,t);function a(e){Z(o,r,i,a,l,"next",e)}function l(e){Z(o,r,i,a,l,"throw",e)}a(void 0)}))}}function w(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return b(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return b(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var k="https://chrisinajar.com:5000/";function S(){var e,n,t=function(e){return e.trim()},o=(0,j.TX)().data,l=(0,i.useState)([]),c=l[0],s=l[1],u=(0,i.useState)(!1),d=u[0],h=u[1],f=(0,i.useState)(""),v=f[0],m=f[1],b=(0,i.useRef)();(0,i.useEffect)((function(){var e;if(!b.current&&(null===o||void 0===o||null===(e=o.chat)||void 0===e?void 0:e.token))return b.current=(0,p.io)(k,{withCredentials:!0,auth:{token:o.chat.token}}),b.current.on("hello",(function(e){s(e.chat)})),b.current.on("chat",(function(e){console.log("Got chat event!",e),s((function(n){return[e].concat(w(n))}))})),function(){b.current&&(b.current.disconnect(),b.current=void 0)}}),[null===o||void 0===o||null===(e=o.chat)||void 0===e?void 0:e.token]);var Z=t(v);function S(){return(S=A(x().mark((function e(n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"===n.key&&b.current){e.next=2;break}return e.abrupt("return");case 2:b.current.emit("chat",{message:v},(function(e){console.log("Got a reply!",e),s((function(n){return[e].concat(w(n))}))})),m("");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)(g.Z,{fullWidth:!0,disabled:!(null===(n=b.current)||void 0===n?void 0:n.connected),value:v,name:"Chat input",label:d?"Max message: ".concat(Z.length,"/").concat(140):"Type here...",placeholder:"Type here...",onChange:function(e){var n=e.target.value;t(n).length<=140&&m(n)},onFocus:function(){return h(!0)},onBlur:function(){return h(!1)},autoComplete:"off",onKeyPress:function(e){return S.apply(this,arguments)}}),(0,r.jsx)(a.Z,{sx:{backgroundColor:"primary.light",padding:1,minHeight:"600px"},children:c.map((function(e){return(0,r.jsxs)("div",{children:[(0,r.jsx)("b",{children:e.from})," ",(0,y.emojify)(e.message)]},e.id)}))}),(0,r.jsx)("br",{})]})}var P=t(3321),C=t(6886),E=t(913),I=t(3841),L=t(2382),F=t(3599),O=t(8456);function T(){var e,n,t,r=(0,j.UE)().data;return null!==(t=null===r||void 0===r||null===(e=r.me)||void 0===e||null===(n=e.account)||void 0===n?void 0:n.hero)&&void 0!==t?t:void 0}var U=t(9835);function W(e,n){if(e===j.hK.Melee)return n?"struck":"missed"}function $(e){var n=e.fight,t=n.monster.monster;return(0,r.jsx)(i.Fragment,{children:(0,r.jsxs)(C.ZP,{style:{minHeight:"110px"},item:!0,xs:6,children:[n.log.map((function(e){return(0,r.jsx)(i.Fragment,{children:(0,r.jsxs)(u.Z,{children:[(0,r.jsx)("b",{children:e.from})," ".concat(W(e.attackType,e.success)," "),(0,r.jsx)("b",{children:e.to}),e.success?" for ".concat(e.damage," damage!"):"."]})},e.from)})),n.victory&&(0,r.jsxs)(u.Z,{children:[t.name," has been killed!",n.experience&&" You gain ".concat(n.experience," experience! "),n.didLevel&&(0,r.jsx)("b",{children:"You leveled up!!"})]})]})})}function M(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function H(e,n,t,r,i,o,a){try{var l=e[o](a),c=l.value}catch(s){return void t(s)}l.done?n(c):Promise.resolve(c).then(r,i)}function N(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var o=e.apply(n,t);function a(e){H(o,r,i,a,l,"next",e)}function l(e){H(o,r,i,a,l,"throw",e)}a(void 0)}))}}function Q(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,o=[],a=!0,l=!1;try{for(t=t.call(e);!(a=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(c){l=!0,i=c}finally{try{a||null==t.return||t.return()}finally{if(l)throw i}}return o}}(e,n)||_(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e){return function(e){if(Array.isArray(e))return M(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,n){if(e){if("string"===typeof e)return M(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?M(e,n):void 0}}var K="Select a monster to challenge",R="Fight a monster!";function B(){var e,n=Q((0,U.g)(),2),t=n[0],o=n[1],a=(0,i.useState)(""),l=a[0],c=a[1],s=(0,i.useState)(""),d=s[0],h=s[1],f=(0,j.Of)(),v=f.data,m=f.loading,p=(f.error,f.refetch),y=Q((0,j.zC)(),2),g=y[0],b=y[1],Z=b.data,A=b.loading,w=Q((0,j.Ht)(),1)[0],k=Q((0,j.hL)(),2),S=k[0],W=k[1].loading,M=(0,j.pL)(),H=M.data,_=M.refetch,B=(null===H||void 0===H?void 0:H.challenges)||[],G=T();function z(){return(z=N(x().mark((function e(){var n,t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S();case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),e.t0.graphQLErrors&&(null===(n=e.t0.graphQLErrors[0])||void 0===n||null===(t=n.extensions)||void 0===t?void 0:t.delay)&&o(e.t0.graphQLErrors[0].extensions.remaining);case 9:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function V(){return(V=N(x().mark((function e(){var n,t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=4,g({variables:{monster:d}});case 4:t=e.sent,(null===(n=t.data)||void 0===n?void 0:n.fight.victory)&&(h(""),p()),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),p();case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function X(){return(X=N(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w({variables:{monster:l}});case 3:p(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),p();case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}return(0,i.useEffect)((function(){_()}),[null===G||void 0===G?void 0:G.location.x,null===G||void 0===G?void 0:G.location.y,null===G||void 0===G?void 0:G.location.map]),(0,i.useEffect)((function(){var e;(null===v||void 0===v||null===(e=v.monsters)||void 0===e?void 0:e.length)&&(""===d?h(v.monsters[0].id):v.monsters.find((function(e){return e.id===d}))||h(v.monsters[0].id))}),[d,null===v||void 0===v||null===(e=v.monsters)||void 0===e?void 0:e.length]),(0,r.jsx)(i.Fragment,{children:(0,r.jsxs)(C.ZP,{container:!0,columns:6,spacing:4,children:[A&&(0,r.jsx)(C.ZP,{item:!0,xs:6,style:{minHeight:"110px"},children:(0,r.jsx)(u.Z,{children:"Loading combat..."})}),Z&&(0,r.jsx)($,{fight:Z.fight}),G&&G.combat.health>0&&(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)(C.ZP,{item:!0,md:3,xs:6,children:(0,r.jsxs)(E.Z,{fullWidth:!0,children:[(0,r.jsx)(I.Z,{id:"challenge-monster-select-label",children:K}),(0,r.jsx)(L.Z,{labelId:"challenge-monster-select-label",value:l,label:K,onChange:function(e){return c(e.target.value)},children:B.map((function(e){return(0,r.jsx)(F.Z,{value:e.id,children:e.name},e.id)}))}),(0,r.jsx)(P.Z,{disabled:!l||t>0||A||W,onClick:function(){return X.apply(this,arguments)},variant:"contained",children:"Challenge!"})]})}),(0,r.jsx)(C.ZP,{item:!0,md:3,xs:6,children:(0,r.jsxs)(E.Z,{fullWidth:!0,children:[(0,r.jsx)(I.Z,{id:"fight-monster-select-label",children:R}),(0,r.jsx)(L.Z,{labelId:"fight-monster-select-label",value:d,label:R,onChange:function(e){return h(e.target.value)},children:(null===v||void 0===v?void 0:v.monsters)&&Y(null===v||void 0===v?void 0:v.monsters).sort((function(e,n){return e.monster.level-n.monster.level})).map((function(e){return(0,r.jsx)(F.Z,{value:e.id,children:e.monster.name},e.id)}))}),m&&(0,r.jsx)(O.Z,{}),(0,r.jsx)(P.Z,{disabled:!d||t>0||A||W,onClick:function(){return V.apply(this,arguments)},variant:"contained",children:"Fight!"})]})})]}),G&&G.combat.health<=0&&(0,r.jsx)(C.ZP,{item:!0,lg:3,xs:6,children:(0,r.jsx)(u.Z,{children:"You are dead."})}),(0,r.jsx)(C.ZP,{item:!0,lg:3,xs:6,children:(0,r.jsx)(P.Z,{fullWidth:!0,onClick:function(){return z.apply(this,arguments)},variant:"contained",disabled:t>0||A||W,children:"Heal"})})]})})}var G=t(9692);function z(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function V(e,n,t,r,i,o,a){try{var l=e[o](a),c=l.value}catch(s){return void t(s)}l.done?n(c):Promise.resolve(c).then(r,i)}function X(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var o=e.apply(n,t);function a(e){V(o,r,i,a,l,"next",e)}function l(e){V(o,r,i,a,l,"throw",e)}a(void 0)}))}}function q(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,o=[],a=!0,l=!1;try{for(t=t.call(e);!(a=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(c){l=!0,i=c}finally{try{a||null==t.return||t.return()}finally{if(l)throw i}}return o}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return z(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return z(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(){var e=T(),n=q((0,U.g)(),2),t=n[0],o=n[1],a=q((0,j.gK)(),2),l=a[0],c=a[1].loading;if(!e)return null;function s(e){return d.apply(this,arguments)}function d(){return(d=X(x().mark((function e(n){var t,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l({variables:{direction:n}});case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),e.t0.graphQLErrors&&(null===(t=e.t0.graphQLErrors[0])||void 0===t||null===(r=t.extensions)||void 0===r?void 0:r.delay)&&o(e.t0.graphQLErrors[0].extensions.remaining);case 9:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}return(0,r.jsx)(i.Fragment,{children:(0,r.jsx)(C.ZP,{container:!0,columns:2,children:(0,r.jsx)(C.ZP,{item:!0,xs:2,sm:1,children:(0,r.jsxs)(C.ZP,{container:!0,columns:6,spacing:3,children:[(0,r.jsx)(C.ZP,{item:!0,style:{textAlign:"center"},xs:6,children:(0,r.jsx)(u.Z,{children:"Use buttons to move around the map."})}),(0,r.jsx)(C.ZP,{item:!0,style:{textAlign:"center"},xs:2}),(0,r.jsx)(C.ZP,{item:!0,style:{textAlign:"center"},xs:2,children:(0,r.jsx)(P.Z,{disabled:c||t>0,variant:"contained",onClick:function(){return s(j.p$.North)},children:"North"})}),(0,r.jsx)(C.ZP,{item:!0,style:{textAlign:"center"},xs:2}),(0,r.jsx)(C.ZP,{item:!0,style:{textAlign:"center"},xs:2,children:(0,r.jsx)(P.Z,{disabled:c||t>0,variant:"contained",onClick:function(){return s(j.p$.West)},children:"West"})}),(0,r.jsx)(C.ZP,{item:!0,style:{textAlign:"center"},xs:2,children:(0,r.jsxs)(u.Z,{children:[e.location.x,", ",e.location.y]})}),(0,r.jsx)(C.ZP,{item:!0,style:{textAlign:"center"},xs:2,children:(0,r.jsx)(P.Z,{disabled:c||t>0,variant:"contained",onClick:function(){return s(j.p$.East)},children:"East"})}),(0,r.jsx)(C.ZP,{item:!0,style:{textAlign:"center"},xs:2}),(0,r.jsx)(C.ZP,{item:!0,style:{textAlign:"center"},xs:2,children:(0,r.jsx)(P.Z,{disabled:c||t>0,variant:"contained",onClick:function(){return s(j.p$.South)},children:"South"})}),(0,r.jsx)(C.ZP,{item:!0,style:{textAlign:"center"},xs:2}),(0,r.jsx)(C.ZP,{item:!0,style:{textAlign:"center"},xs:6,children:(0,r.jsx)(u.Z,{children:"(Visual map coming very soon)"})})]})})})})}function J(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function ee(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,o=[],a=!0,l=!1;try{for(t=t.call(e);!(a=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(c){l=!0,i=c}finally{try{a||null==t.return||t.return()}finally{if(l)throw i}}return o}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return J(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return J(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(){var e=(0,o.useRouter)(),n=ee((0,G.d)(),2),t=n[0],m=(n[1],(0,j.UE)()),x=(m.data,m.loading),p=m.error,y=(0,i.useState)("3"),g=y[0],b=y[1];return p||!t?(e.push("/?auth=".concat(e.asPath)),(0,r.jsxs)(v.A,{children:[(0,r.jsx)("br",{}),"Redirecting..."]})):x?(0,r.jsx)(v.A,{children:x&&(0,r.jsx)(c.Z,{})}):(0,r.jsx)(v.A,{showHero:!0,children:(0,r.jsxs)(a.Z,{sx:{width:"100%",typography:"body1"},children:[(0,r.jsxs)(d.ZP,{value:g,children:[(0,r.jsx)(a.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,r.jsxs)(h.Z,{onChange:function(e,n){b(n)},"aria-label":"navigation tabs",children:[(0,r.jsx)(s.Z,{label:"Welcome / News",value:"1"}),(0,r.jsx)(s.Z,{label:"Combat",value:"2"}),(0,r.jsx)(s.Z,{label:"Map",value:"3"})]})}),(0,r.jsxs)(f.Z,{value:"1",children:[(0,r.jsx)(u.Z,{children:"Welcome to the game! I'm updating things extremely regularly, so check back often and refresh often. Use the tabs above to navigate around."}),(0,r.jsx)("br",{}),(0,r.jsx)(u.Z,{children:"You can find chat below, it keeps the last 50 messages, or since the server last restarted. Emoji's are fully supported and encouraged."})]}),(0,r.jsxs)(f.Z,{value:"2",children:[(0,r.jsx)(u.Z,{children:"Challenge a monster from the list, then fight it to the death. Note that other players in the same location see the same monster lists, so they may get to it first!"}),(0,r.jsx)("br",{}),(0,r.jsx)(B,{})]}),(0,r.jsx)(f.Z,{value:"3",children:(0,r.jsx)(D,{})})]}),(0,r.jsx)("br",{}),(0,r.jsx)(l.Z,{}),(0,r.jsx)("br",{}),(0,r.jsx)(S,{})]})})}}}]);