"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[799],{2799:function(e,n,t){t.r(n),t.d(n,{default:function(){return X}});var r=t(5893),o=t(7294),i=t(1163),a=t(7357),l=t(7720),c=t(1458),u=t(44),s=t(5861),d=t(5670),h=t(7225),f=t(5050),v=t(1320),m=t(4051),p=t.n(m),x=t(1157),y=t(8445),g=t(5449),b=t(9402);function j(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function Z(e,n,t,r,o,i,a){try{var l=e[i](a),c=l.value}catch(u){return void t(u)}l.done?n(c):Promise.resolve(c).then(r,o)}function w(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){Z(i,r,o,a,l,"next",e)}function l(e){Z(i,r,o,a,l,"throw",e)}a(void 0)}))}}function k(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return j(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return j(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var A="https://chrisinajar.com:5000/";function S(){var e,n,t=function(e){return e.trim()},i=(0,b.TX)().data,l=(0,o.useState)([]),c=l[0],u=l[1],s=(0,o.useState)(!1),d=s[0],h=s[1],f=(0,o.useState)(""),v=f[0],m=f[1],j=(0,o.useRef)();(0,o.useEffect)((function(){var e;if(!j.current&&(null===i||void 0===i||null===(e=i.chat)||void 0===e?void 0:e.token))return j.current=(0,x.io)(A,{withCredentials:!0,auth:{token:i.chat.token}}),j.current.on("hello",(function(e){u(e.chat)})),j.current.on("chat",(function(e){console.log("Got chat event!",e),u((function(n){return[e].concat(k(n))}))})),function(){j.current&&(j.current.disconnect(),j.current=void 0)}}),[null===i||void 0===i||null===(e=i.chat)||void 0===e?void 0:e.token]);var Z=t(v);function S(){return(S=w(p().mark((function e(n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"===n.key&&j.current){e.next=2;break}return e.abrupt("return");case 2:j.current.emit("chat",{message:v},(function(e){console.log("Got a reply!",e),u((function(n){return[e].concat(k(n))}))})),m("");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,r.jsxs)(o.Fragment,{children:[(0,r.jsx)(g.Z,{fullWidth:!0,disabled:!(null===(n=j.current)||void 0===n?void 0:n.connected),value:v,name:"Chat input",label:d?"Max message: ".concat(Z.length,"/").concat(140):"Type here...",placeholder:"Type here...",onChange:function(e){var n=e.target.value;t(n).length<=140&&m(n)},onFocus:function(){return h(!0)},onBlur:function(){return h(!1)},autoComplete:"off",onKeyPress:function(e){return S.apply(this,arguments)}}),(0,r.jsx)(a.Z,{sx:{backgroundColor:"primary.light",padding:1,minHeight:"600px"},children:c.map((function(e){return(0,r.jsxs)("div",{children:[(0,r.jsx)("b",{children:e.from})," ",(0,y.emojify)(e.message)]},e.id)}))}),(0,r.jsx)("br",{})]})}var C=t(3321),E=t(6886),I=t(913),P=t(3841),F=t(2382),T=t(3599),L=t(8456);var O=t(9835);function H(e,n){if(e===b.hK.Melee)return n?"struck":"missed"}function U(e){var n=e.fight,t=n.monster.monster;return(0,r.jsx)(o.Fragment,{children:(0,r.jsxs)(E.ZP,{style:{minHeight:"110px"},item:!0,xs:6,children:[n.log.map((function(e){return(0,r.jsx)(o.Fragment,{children:(0,r.jsxs)(s.Z,{children:[(0,r.jsx)("b",{children:e.from})," ".concat(H(e.attackType,e.success)," "),(0,r.jsx)("b",{children:e.to}),e.success?" for ".concat(e.damage," damage!"):"."]})},e.from)})),n.victory&&(0,r.jsxs)(s.Z,{children:[t.name," has been killed!",n.experience&&" You gain ".concat(n.experience," experience! "),n.didLevel&&(0,r.jsx)("b",{children:"You leveled up!!"})]})]})})}function W(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function M(e,n,t,r,o,i,a){try{var l=e[i](a),c=l.value}catch(u){return void t(u)}l.done?n(c):Promise.resolve(c).then(r,o)}function N(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){M(i,r,o,a,l,"next",e)}function l(e){M(i,r,o,a,l,"throw",e)}a(void 0)}))}}function Y(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,i=[],a=!0,l=!1;try{for(t=t.call(e);!(a=(r=t.next()).done)&&(i.push(r.value),!n||i.length!==n);a=!0);}catch(c){l=!0,o=c}finally{try{a||null==t.return||t.return()}finally{if(l)throw o}}return i}}(e,n)||Q(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e){return function(e){if(Array.isArray(e))return W(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Q(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(e,n){if(e){if("string"===typeof e)return W(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?W(e,n):void 0}}var R="Select a monster to challenge",$="Fight a monster!";function B(){var e,n=Y((0,O.g)(),2),t=n[0],i=n[1],a=(0,o.useState)(""),l=a[0],c=a[1],u=(0,o.useState)(""),d=u[0],h=u[1],f=(0,b.Of)(),v=f.data,m=f.loading,x=(f.error,f.refetch),y=Y((0,b.zC)(),2),g=y[0],j=y[1],Z=j.data,w=j.loading,k=Y((0,b.Ht)(),1)[0],A=Y((0,b.hL)(),1)[0],S=(0,b.pL)(),H=S.data,W=S.refetch,M=(null===H||void 0===H?void 0:H.challenges)||[],Q=function(){var e,n,t,r=(0,b.UE)().data;return null!==(t=null===r||void 0===r||null===(e=r.me)||void 0===e||null===(n=e.account)||void 0===n?void 0:n.hero)&&void 0!==t?t:void 0}();function B(){return(B=N(p().mark((function e(){var n,t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A();case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),e.t0.graphQLErrors&&(null===(n=e.t0.graphQLErrors[0])||void 0===n||null===(t=n.extensions)||void 0===t?void 0:t.delay)&&i(e.t0.graphQLErrors[0].extensions.remaining);case 9:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function G(){return(G=N(p().mark((function e(){var n,t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=4,g({variables:{monster:d}});case 4:t=e.sent,(null===(n=t.data)||void 0===n?void 0:n.fight.victory)&&(h(""),x()),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),x();case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function K(){return(K=N(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k({variables:{monster:l}});case 3:x(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),x();case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}return(0,o.useEffect)((function(){W()}),[null===Q||void 0===Q?void 0:Q.location.x,null===Q||void 0===Q?void 0:Q.location.y,null===Q||void 0===Q?void 0:Q.location.map]),(0,o.useEffect)((function(){var e;""===d&&(null===v||void 0===v||null===(e=v.monsters)||void 0===e?void 0:e.length)&&h(null===v||void 0===v?void 0:v.monsters[0].id)}),[d,null===v||void 0===v||null===(e=v.monsters)||void 0===e?void 0:e.length]),(0,r.jsx)(o.Fragment,{children:(0,r.jsxs)(E.ZP,{container:!0,columns:6,spacing:4,children:[w&&(0,r.jsx)(E.ZP,{item:!0,xs:6,style:{minHeight:"110px"},children:(0,r.jsx)(s.Z,{children:"Loading combat..."})}),Z&&(0,r.jsx)(U,{fight:Z.fight}),Q&&Q.combat.health>0&&(0,r.jsxs)(o.Fragment,{children:[(0,r.jsx)(E.ZP,{item:!0,md:3,xs:6,children:(0,r.jsxs)(I.Z,{fullWidth:!0,children:[(0,r.jsx)(P.Z,{id:"challenge-monster-select-label",children:R}),(0,r.jsx)(F.Z,{labelId:"challenge-monster-select-label",value:l,label:R,onChange:function(e){return c(e.target.value)},children:M.map((function(e){return(0,r.jsx)(T.Z,{value:e.id,children:e.name},e.id)}))}),(0,r.jsx)(C.Z,{disabled:!l||t>0,onClick:function(){return K.apply(this,arguments)},variant:"contained",children:"Challenge!"})]})}),(0,r.jsx)(E.ZP,{item:!0,md:3,xs:6,children:(0,r.jsxs)(I.Z,{fullWidth:!0,children:[(0,r.jsx)(P.Z,{id:"fight-monster-select-label",children:$}),(0,r.jsx)(F.Z,{labelId:"fight-monster-select-label",value:d,label:$,onChange:function(e){return h(e.target.value)},children:(null===v||void 0===v?void 0:v.monsters)&&_(null===v||void 0===v?void 0:v.monsters).sort((function(e,n){return e.monster.level-n.monster.level})).map((function(e){return(0,r.jsx)(T.Z,{value:e.id,children:e.monster.name},e.id)}))}),m&&(0,r.jsx)(L.Z,{}),(0,r.jsx)(C.Z,{disabled:!d||t>0,onClick:function(){return G.apply(this,arguments)},variant:"contained",children:"Fight!"})]})})]}),Q&&Q.combat.health<=0&&(0,r.jsx)(E.ZP,{item:!0,lg:3,xs:6,children:(0,r.jsx)(s.Z,{children:"You are dead."})}),(0,r.jsx)(E.ZP,{item:!0,lg:3,xs:6,children:(0,r.jsx)(C.Z,{fullWidth:!0,onClick:function(){return B.apply(this,arguments)},variant:"contained",disabled:t>0,children:"Heal"})})]})})}var G=t(9692);function K(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function z(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,i=[],a=!0,l=!1;try{for(t=t.call(e);!(a=(r=t.next()).done)&&(i.push(r.value),!n||i.length!==n);a=!0);}catch(c){l=!0,o=c}finally{try{a||null==t.return||t.return()}finally{if(l)throw o}}return i}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return K(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return K(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(){var e=(0,i.useRouter)(),n=z((0,G.d)(),2),t=n[0],m=(n[1],(0,b.UE)()),p=(m.data,m.loading),x=m.error,y=(0,o.useState)("1"),g=y[0],j=y[1];return x||!t?(e.push("/?auth=".concat(e.asPath)),(0,r.jsxs)(v.A,{children:[(0,r.jsx)("br",{}),"Redirecting..."]})):p?(0,r.jsx)(v.A,{children:p&&(0,r.jsx)(c.Z,{})}):(0,r.jsx)(v.A,{showHero:!0,children:(0,r.jsxs)(a.Z,{sx:{width:"100%",typography:"body1"},children:[(0,r.jsxs)(d.ZP,{value:g,children:[(0,r.jsx)(a.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,r.jsxs)(h.Z,{onChange:function(e,n){j(n)},"aria-label":"navigation tabs",children:[(0,r.jsx)(u.Z,{label:"Welcome / News",value:"1"}),(0,r.jsx)(u.Z,{label:"Combat",value:"2"})]})}),(0,r.jsxs)(f.Z,{value:"1",children:[(0,r.jsx)(s.Z,{children:"Welcome to the game! I'm updating things extremely regularly, so check back often and refresh often. Use the tabs above to navigate around."}),(0,r.jsx)("br",{}),(0,r.jsx)(s.Z,{children:"You can find chat below, it keeps the last 50 messages, or since the server last restarted. Emoji's are fully supported and encouraged."})]}),(0,r.jsxs)(f.Z,{value:"2",children:[(0,r.jsx)(s.Z,{children:"Challenge a monster from the list, then fight it to the death. Note that other players in the same location see the same monster lists, so they may get to it first!"}),(0,r.jsx)("br",{}),(0,r.jsx)(B,{})]})]}),(0,r.jsx)("br",{}),(0,r.jsx)(l.Z,{}),(0,r.jsx)("br",{}),(0,r.jsx)(S,{})]})})}}}]);